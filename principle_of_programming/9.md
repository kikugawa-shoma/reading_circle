# 第 4 章前半

## 4.1 凝集度

- 凝集度：モジュールに含まれている機能の純粋さ

- [このサイト](https://cyzennt.co.jp/blog/2019/03/16/%E3%80%8C%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E5%BC%B7%E5%BA%A6%E3%81%A8%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E7%B5%90%E5%90%88%E5%BA%A6%E3%80%8D%E3%81%AE%E5%9B%B3%E8%A7%A3/)の図がわかりやすい

- 分割したモジュールは各々が独立している必要がある

- モジュールの内で関連が最大、モジュール間で最小が理想

### レベル 1.暗号的強度

- たまたま現れた同じ処理のパターンをモジュールにしてまとめた場合がこのレベル

- 他モジュールと強く関連してしまう->変更の影響が他のモジュールに及んでしまう

---

- 「同じ処理が現れて何回も同じ処理書くのは面倒だからモジュール化しよう」という発想で安直にモジュール化すると凝集度が低いモジュールとなってしまう

### レベル 2.論理的強度モジュール

- ある機能を抽象的に捉えてまとめたもの

- 例）入出力操作をまとめたり、予約操作をまとめたり

- 呼び出したときに一つの機能（関数）のみが使用される（モジュール内の命令の関連度が低い）

- どの機能を使用するかを引数で決める

- 良い面もある

  - 必然的にモジュール内で論理を共有できることがある

  - 関連した機能が集まったモジュールなので使いやすい

  - 特定データに関する処理がモジュールに集まる->そのデータの変更に対応するためにモジュールのみを改修すればよい

### レベル 3.時間的強度

- 処理の内容自体に関連はないが、同じ時間に実行する処理をモジュールとしてまとめる場合

- 例）初期処理モジュール

### レベル 4.手順的強度

- 複数個の機能を「手順」としてまとめてモジュールにする

- 時間的関連性＋手順的関連性

- 複数機能をまとめてしまうので、そのなかの一部の機能のみ使用することができない。かといってばらしてしまうと論理的強度に成り下がってしまう

### レベル 5.連絡的強度

- 手順的関連性＋モジュール内の機能間でデータの受け渡しを行う

### レベル 6.情報的強度

- 特定の同じデータを扱うための複数の機能をまとめたもの

- データ修正の影響がそのモジュール内に閉じる

### レベル 7.機能的強度

- モジュール内のすべての命令が一つの機能を実現するために関連しあっているモジュール

## 4.2 結合度

- モジュール間は疎結合に

- 密結合だと影響範囲が広がる

- 呼び出すモジュールをブラックボックス化できない

- 疎結合にするには

  - 引数でデータを受け渡し

  - グローバル変数はなるべく使わない。変数をなるべく外部公開しない

  - スイッチ変数で動作を変えるようなコードを書かない

- ハイブリッド結合もよろしくない（スイッチ変数を兼用していると考えられるため）

- 結合度の測り方は「強さ」と「本数」と「方向」

- 冪等性と安全性

  - HTTP の GET メソッドは冪等性と安全性を持っているべき

### レベル 1.内容結合

- 外部宣言していないデータを直接参照したりするケース

- 高級言語ではそもそも意図的にやらないとできない

### レベル 2.共通結合

- グローバル変数をモジュール各々が使用している場合

- グローバル変数を書き換えた場合の影響が他モジュールに波及する

- 受け渡しパラメータを減らすメリットもあるが、受け渡しパラメータの数が多くなるのは設計が悪い（ことが多い）

### レベル 3.外部結合

- 外部宣言したデータだけをモジュール間で共有する場合

### レベル 4.制御結合

- 呼び出し側モジュールが呼び出されるモジュールの制御（スイッチ変数）を指示するデータをパラメータとして渡す場合

- データの共有はされていない

### レベル 5.スタンプ結合

- 共有していないデータを構造体の形でモジュール間で受け渡しする場合

- データ構造の受け渡しは引数を用いて行われる

- 構造体で渡されるので、不必要なデータまで渡している
  場合がある

### レベル 6.データ結合

- モジュール間のデータの受け渡しがスカラ型の要素のみ

- 呼び出すモジュールをブラックボックス化できる->思考範囲を狭められる

- 構造体を受け渡ししていても構造体のすべての要素を渡された側で使用しているならそれはデータ結合とみなして良い

## 4.3 直行性

- 直行性=独立性

- コードの変更が他のコードに影響しないこと

- データベースにアクセスするコードとユーザーインターフェースのコードは（うまく設計すれば）直行する

- 開発コスト削減・再利用促進・コードが堅牢になる・テストしやすい

- 他のモジュールの実装を当てにしないコードを書く

- レイヤー化することで直行性を持たせられる。各レイヤーはその直下のレイヤーの機能を使用する

- 例）TCP/IP

- リレーショナル・データベースにおける直行性とは意味が異なるので注意
  - リレーションの直行性・・・テーブル「間」の重複をなくすこと

---

- バックエンドとフロントエンドに切り分けるやり方もこれを目指していると言える

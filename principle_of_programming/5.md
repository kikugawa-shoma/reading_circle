# 7 つの設計原理

- バグを生まないための 7 つの観点を紹介

- 単純、同型、対照、階層、線形、明証、安全原理の 7 つ

- コードレビューは品質を担保するのに有効。ただし、コードレビューが機能するためには統一された観点、基準が必要。設計原理がそのためのもの

- 当然レビュー時だけでなくコードを書くときにも意識しよう

## 3.30 単純原理

- シンプルにこだわる(「初心者でも読める」を意識する)

- 複雑なところにバグは生まれる -> シンプルにコードを書けばバグを減らせる

---

- KISS(Keep it simple stupid)でも言っていた

## 3.31 同型原理

- 同じことは同じように扱う。例外を設けない。(数値の単位然り、公開関数の引数の型然り、使用順序然り)

- 統一感のあるコードは美しい。美しいものは理解しやすい

---

- チームでの開発なら自分の担当箇所の書き方は他の人のコードの書き方に倣って書くべき

- コーディング規約がある理由の 1 つだと思う

## 3.32 対称原理

- 「対」を意識し、形の対称性にこだわる

- 対称性は美しい

- 対称性を意識しながら設計することで考慮漏れを防ぐことができる

- 条件があれば反条件も考える

- 命名の対称性

---

- [プリグラミングでよく使う英単語まとめ](https://qiita.com/Ted-HM/items/7dde25dcffae4cdc7923):この記事に対になる命名が掲載されてあるので参考に

## 3.33 階層原理

- 構造が階層であることにこだわる

- 同一処理は同一階層で行う

- 階層構造が把握できるとコードが読みやすい

- 上位から見たとき、下位レベルは「それを外部から見ている」ような視点で記述する。

---

- SLAP(Singele Level of Abstraction Principle)でも言っていた

- 上位レベルから呼び出すとき分かりやすくするには下位側にどのようなメソッドをどのような引数で用意すればよいかを考えるということ

- React は階層的に書きやすくなっているから流行っている

## 3.34 線形原理

- 処理の流れは直線的であることにこだわる

- バグは処理の流れが直線的でなく複雑になっているところに生まれる

- 処理の分岐をなるべく減らす

---

- 分岐とか状態数が少ないほうがデバッグもしやすい(分岐/状態があるとまずどの分岐/状態がエラーの原因になっているかを探るところから始まる)

- 一般に線形なものは解析しやすい(だから線形代数が学問として成立している)

## 3.35 明証原理

- 一見して明らかに正しいと言えるコードを書く。

- コードを見て自明でない部分には明証を加える。明証の手段は問わない(コメントでもドキュメントでも図でも)

- 可読性が担保される

- コードを再利用するときはそのコードを完全に理解する必要がある。

- コードを修正するときは再利用するとき以上にそのコードを理解する必要がある -> 障害のケースのみ確認ではデグレードの危険性。全パターンを網羅したテストで担保することが必要

---

- ハードウェアの場合どのような環境で使われるかが明確。 -> 作成しようとしているものと同じような環境で使われているものの設計を流用(import)すればうまくいく

- ソフトウェアの場合、どのような環境で使われているのかが不明確(実際に使われているプログラムのソースコードを読むしか無い。ソースコードは非公開の場合もありうる)。それが原因で不具合が起きる可能性がある

## 3.36 安全原理

- 曖昧なところは安全サイドで設計、プログラミングする

- 「ありえない」をあえて考慮する

- 大事故を防ぐ目的

- どの程度に安全サイドに倒すかは事前に合意形成しておく

- 仕様書はあくまでプログラムの必要条件を記述したもの。エラーが起きた場合どう挙動するようにするのかなどの十分条件はプログラマの手に委ねられている

---

- 作っているシステムに合わせた安全性が求められる。(金融系のシステムなら安全よりだしスタートアップのサービスならそこまで安全でなくても早く開発することが求められそう)

- 非機能要件定義がこの役割を担っている
